upstream MSStack_web {
  server 172.31.2.231:81;
  server 172.31.6.191:81;
  server 172.31.34.198:81;
 }

 upstream MSStack_backofficeweb {
   server 172.31.2.231:84;
   server 172.31.6.191:84;
   server 172.31.34.198:84;
 }

 upstream MSStack_authenticationservice {
     server 172.31.2.231:8040;
     server 172.31.6.191:8040;
     server 172.31.34.198:8040;
 }

 upstream MSStack_socketservice {
      server 172.31.2.231:8039;
      server 172.31.6.191:8039;
      server 172.31.34.198:8039;
 }

 upstream MSStack_messageservice {
     server 172.31.2.231:8037;
     server 172.31.6.191:8037;
     server 172.31.34.198:8037;
 }

 upstream MSStack_historyservice {
     server 172.31.2.231:8051;
     server 172.31.6.191:8051;
     server 172.31.34.198:8051;
 }

 upstream MSStack_transactionservice {
      server 172.31.2.231:8020;
      server 172.31.6.191:8020;
      server 172.31.34.198:8020;
  }





server {

  listen 443 ssl;

  server_name lb.monifair.com;
  ssl on;
  ssl_certificate      /certs/chain.crt;
  ssl_certificate_key  /certs/chain.key;
  ssl_protocols TLSv1.2 TLSv1.1 TLSv1;

  add_header Strict-Transport-Security max-age=500;



  location / {
    auth_basic "Restricted Content";
    auth_basic_user_file /etc/nginx/.htpasswd;
    proxy_pass https://web/;
  }

  location /MSStack_backofficeweb {
    auth_basic "Restricted Content";
    auth_basic_user_file /etc/nginx/.htpasswd;
    proxy_pass https://backofficeweb/;
  }

  location /backoffice {
    proxy_pass https:///MSStack_backofficeservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backoffice/loggedin {
    proxy_pass https:///MSStack_backofficeservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backoffice/searchforuserbyphonenr {
    proxy_pass https:///MSStack_backofficeservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backoffice/listallusers {
    proxy_pass https:///MSStack_backofficeservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backoffice/activateuser {
    proxy_pass https:///MSStack_backofficeservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backoffice/deactivateuser {
    proxy_pass https:///MSStack_backofficeservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backoffice/createemployee {
    proxy_pass https:///MSStack_backofficeservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backoffice/deleteall {
    proxy_pass https:///MSStack_backofficeservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backoffice/deleteemployee {
    proxy_pass https:///MSStack_backofficeservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backoffice/authenticatebyphonenr {
    proxy_pass https:///MSStack_authenticationservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backofficeroutes/deleteall {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backofficeroutes/activateuserwithtoken {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backofficeroutes/deactivateuserwithtoken {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backofficeroutes/deleteuserwithtoken {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backofficeroutes/usertokenbyphonenr {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backofficeroutes/getuser {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backofficeroutes/listallusers {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backofficeroutes/deleteuser {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /createuser {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /getuser {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /getuserbytoken {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /updatephone {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /updatepassword {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /confirmsignupcode {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

    location /confirmloginmobile {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

    location /confirmlogincode {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /resendcode {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /deleteall {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /deleteuser  {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

    location /forgotpassword  {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

    location /resetpassword  {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /authenticate {
    proxy_pass https:///MSStack_authenticationservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /authenticated {
    proxy_set_header Host $host;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /login {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /loggedin {
    proxy_pass https:///MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /register {
    proxy_pass https:///MSStack_messageservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /sendmessage {
    proxy_pass https:///MSStack_messageservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /getmessages {
    proxy_pass https:///MSStack_messageservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /getmessage {
    proxy_pass https:///MSStack_messageservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /deletemessage {
    proxy_pass https://MSStack_messageservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

    location /sendemail {
    proxy_pass https://MSStack_messageservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /getsocket {
    proxy_pass https://MSStack_socketservice/socket.io/socket.io.js;
    proxy_set_header Upgrade $http_upgrade;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /socket.io {
    proxy_pass https://MSStack_socketservice/socket.io/;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    proxy_set_header Host $host;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /savehistory {
    proxy_pass https://MSStack_historyservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /getallhistory {
    proxy_pass https://MSStack_historyservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /getallhistoryforobject {
    proxy_pass https://MSStack_historyservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /createaccount {
    proxy_pass https://MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /addcontractaddress {
    proxy_pass https://MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /getallaccounts {
    proxy_pass https://MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /getallaccountsforuserbyid {
    proxy_pass https://MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }
  location /getallaccountsforuserbytoken {
    proxy_pass https://MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backofficeroutes/deleteallforuser {
    proxy_pass https://MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  location /backofficeroutes/removeallaccounts {
    proxy_pass https://MSStack_userandaccountservice;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
  }

  proxy_pass https://MSStack_transactionservice/info;
  location /info {
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
   }

  location /savetransactionalaccountinfo{
    proxy_pass https://MSStack_transactionservice/savetransactionalaccountinfo;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
    proxy_read_timeout 2500;
  }
 location /getuseramount {
    proxy_pass https://MSStack_transactionservice/getuseramount;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
    proxy_read_timeout 2500;
   }
  location /getcoinbaseaccount {
    proxy_pass https://MSStack_transactionservice/getcoinbaseaccount;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_cache_bypass $http_upgrade;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_ssl_certificate     /certs/chain.crt;
    proxy_ssl_certificate_key /certs/chain.key;
    proxy_read_timeout 2500;
   }

   location /createethereumaccount {
     proxy_pass https://MSStack_transactionservice/createethereumaccount;
     proxy_http_version 1.1;
     proxy_set_header Upgrade $http_upgrade;
     proxy_set_header Connection 'upgrade';
     proxy_cache_bypass $http_upgrade;
     proxy_set_header Host $host;
     proxy_set_header X-Real-IP $remote_addr;
     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
     proxy_set_header X-Forwarded-Proto https;
     proxy_ssl_certificate     /certs/chain.crt;
     proxy_ssl_certificate_key /certs/chain.key;
     proxy_read_timeout 2500;
    }

    location /checkallbalances{
      proxy_pass https://MSStack_transactionservice/checkallbalances;
      proxy_http_version 1.1;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection 'upgrade';
      proxy_cache_bypass $http_upgrade;
      proxy_set_header Host $host;
      proxy_set_header X-Real-IP $remote_addr;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Proto https;
      proxy_ssl_certificate     /certs/chain.crt;
      proxy_ssl_certificate_key /certs/chain.key;
      proxy_read_timeout 2500;
     }

    location /getlistofaccounts{
      proxy_pass https://MSStack_transactionservice/getlistofaccounts;
      proxy_http_version 1.1;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection 'upgrade';
      proxy_cache_bypass $http_upgrade;
      proxy_set_header Host $host;
      proxy_set_header X-Real-IP $remote_addr;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Proto https;
      proxy_ssl_certificate     /certs/chain.crt;
      proxy_ssl_certificate_key /certs/chain.key;
      proxy_read_timeout 2500;
     }

    location /getaccountgasbalance{
      proxy_pass https://MSStack_transactionservice/getaccountgasbalance;
      proxy_http_version 1.1;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection 'upgrade';
      proxy_cache_bypass $http_upgrade;
      proxy_set_header Host $host;
      proxy_set_header X-Real-IP $remote_addr;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Proto https;
      proxy_ssl_certificate     /certs/chain.crt;
      proxy_ssl_certificate_key /certs/chain.key;
      proxy_read_timeout 2500;
     }

    location /transfergasbalance{
         proxy_pass https://MSStack_transactionservice/transfergasbalance;
         proxy_http_version 1.1;
         proxy_set_header Upgrade $http_upgrade;
         proxy_set_header Connection 'upgrade';
         proxy_cache_bypass $http_upgrade;
         proxy_set_header Host $host;
         proxy_set_header X-Real-IP $remote_addr;
         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
         proxy_set_header X-Forwarded-Proto https;
         proxy_ssl_certificate     /certs/chain.crt;
         proxy_ssl_certificate_key /certs/chain.key;
         proxy_read_timeout 2500;
    }

    location /getaccountcontract{
       proxy_pass https://MSStack_transactionservice/getaccountcontract;
       proxy_http_version 1.1;
       proxy_set_header Upgrade $http_upgrade;
       proxy_set_header Connection 'upgrade';
       proxy_cache_bypass $http_upgrade;
       proxy_set_header Host $host;
       proxy_set_header X-Real-IP $remote_addr;
       proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
       proxy_set_header X-Forwarded-Proto https;
       proxy_ssl_certificate     /certs/chain.crt;
       proxy_ssl_certificate_key /certs/chain.key;
       proxy_read_timeout 2500;
      }

      location /bankcapitalcontract{
        proxy_pass https://MSStack_transactionservice/getbankcapitalcontract;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_cache_bypass $http_upgrade;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto https;
        proxy_ssl_certificate     /certs/chain.crt;
        proxy_ssl_certificate_key /certs/chain.key;
        proxy_read_timeout 2500;
       }


     location /netstats{
         proxy_pass http://MSStack_transactionservice/netstats;
         proxy_http_version 1.1;
         proxy_set_header Upgrade $http_upgrade;
         proxy_set_header Connection 'upgrade';
         proxy_cache_bypass $http_upgrade;
         proxy_set_header Host $host;
         proxy_set_header X-Real-IP $remote_addr;
         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
         proxy_set_header X-Forwarded-Proto https;
         proxy_ssl_certificate     /certs/chain.crt;
         proxy_ssl_certificate_key /certs/chain.key;
         proxy_read_timeout 1000;
     }

}
